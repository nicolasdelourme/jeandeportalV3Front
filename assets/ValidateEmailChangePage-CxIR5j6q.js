import{A as e,l as a,m as t,ae as s,G as l,I as o,H as r,K as i,Q as n,U as u,V as c,u as d,ad as p}from"./vue-vendor-BHZkLje3.js";import{a as v,c as m,g as f,t as y}from"./index-BamJDk-5.js";import{c as x,d as h}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-Br6uEOr3.js";import{_ as g}from"./AuthFormWrapper.vue_vue_type_script_setup_true_lang-B8TL4y5H.js";import"./ui-vendor-Dpzf4R5k.js";import"./index-j_h2RxZR.js";const w={key:0,class:"space-y-6 text-center py-8"},_={key:1,class:"space-y-6 text-center py-4"},k={class:"space-y-2"},j={class:"text-neutral-600"},b={key:2,class:"space-y-6 text-center py-4"},C={class:"space-y-2"},V={class:"text-neutral-600"},z={class:"space-y-3"},L=e({__name:"ValidateEmailChangePage",setup(e){const L=s(),A=p(),E=v(),M=a(!0),B=a(!1),H=a("");t(async()=>{const e=L.params.hash;if(!e)return M.value=!1,B.value=!1,void(H.value="Le lien de validation est invalide. Aucun code fourni.");try{const a=await m.validateEmailChange(e);B.value="success"===a.status,B.value?(H.value="Votre adresse email a été modifiée avec succès.",await E.refreshUser()):H.value=a.message||"Le lien de validation est invalide ou a expiré."}catch(a){B.value=!1,H.value=f(a)}finally{M.value=!1}});const I=()=>{B.value&&y.success("Votre adresse email a été mise à jour !"),A.push("/mon-compte")},R=()=>{A.push("/auth?mode=login")};return(e,a)=>(r(),l(x,null,{default:o(()=>[i(g,{title:M.value?"Validation en cours...":B.value?"Email modifié !":"Erreur de validation",subtitle:""},{default:o(()=>[M.value?(r(),n("div",w,[...a[0]||(a[0]=[u("div",{class:"mx-auto w-16 h-16 flex items-center justify-center"},[u("svg",{class:"animate-spin w-10 h-10 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[u("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),u("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),u("p",{class:"text-neutral-600"},"Validation de votre nouvelle adresse email...",-1)])])):B.value?(r(),n("div",_,[a[2]||(a[2]=u("div",{class:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center"},[u("svg",{class:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),u("div",k,[u("p",j,c(H.value),1)]),i(d(h),{type:"button",color:"primary",rounded:"lg",size:"lg",class:"w-full text-secondary hover:text-secondary",onClick:I},{default:o(()=>[...a[1]||(a[1]=[u("span",{class:"font-bold"},"Retour à mon compte",-1)])]),_:1})])):(r(),n("div",b,[a[5]||(a[5]=u("div",{class:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center"},[u("svg",{class:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),u("div",C,[u("p",V,c(H.value),1)]),u("div",z,[i(d(h),{type:"button",color:"primary",rounded:"lg",size:"lg",class:"w-full text-secondary hover:text-secondary",onClick:I},{default:o(()=>[...a[3]||(a[3]=[u("span",{class:"font-bold"},"Retour à mon compte",-1)])]),_:1}),i(d(h),{type:"button",variant:"outline",size:"lg",class:"w-full",onClick:R},{default:o(()=>[...a[4]||(a[4]=[u("span",null,"Se reconnecter",-1)])]),_:1})]),a[6]||(a[6]=u("p",{class:"text-xs text-neutral-500"}," Le lien de validation est valable 15 minutes. Si le problème persiste, demandez un nouveau lien depuis votre compte. ",-1))]))]),_:1},8,["title"])]),_:1}))}});export{L as default};
