import{A as e,l as t,ae as a,a as s,w as l,G as r,I as u,H as o,K as i,Q as n,L as v,U as p,u as m,V as g,W as c,ad as _}from"./vue-vendor-BHZkLje3.js";import{a as d,t as y,l as f,g as x,c as b}from"./index-BamJDk-5.js";import{c as w,b as j,F as h,d as k}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-Br6uEOr3.js";import{_ as z}from"./AuthFormWrapper.vue_vue_type_script_setup_true_lang-B8TL4y5H.js";import{_ as C,a as A,b as T,c as L}from"./AuthModeToggle.vue_vue_type_script_setup_true_lang-CSKWYj3F.js";import"./ui-vendor-Dpzf4R5k.js";import"./index-j_h2RxZR.js";import"./form-vendor-D_96SOpp.js";import"./FormMessage.vue_vue_type_script_setup_true_lang-DUUurZV1.js";import"./Label.vue_vue_type_script_setup_true_lang-BNDbxbZU.js";import"./Input.vue_vue_type_script_setup_true_lang-DxIiTCa0.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-EZWj0bVF.js";import"./FormDescription.vue_vue_type_script_setup_true_lang-BY5sBFTO.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-DUvcT-d5.js";const P={key:2,class:"space-y-6 text-center"},V={class:"mx-auto w-16 h-16 bg-secondary rounded-full flex items-center justify-center"},E={class:"space-y-2"},F={class:"font-medium text-neutral-900"},M=e({__name:"AuthPage",setup(e){const M=_(),U=a(),q=d(),D=t(U.query.mode||"login"),I=t(!1),N=t({}),S=t(!1),W=t(""),G=async e=>{I.value=!0,N.value.general="";try{const t=U.query.redirect||void 0,a=await q.login({email:e.email,password:e.password,rememberMe:e.rememberMe,redirectUrl:t});y.success("Connexion réussie !");const s=t||a;await M.push(s)}catch(t){f.error("❌ [AUTH PAGE] Erreur lors du login:",t),N.value.general=x(t)}finally{I.value=!1}},H=async e=>{I.value=!0,N.value.general="";try{await q.register({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,passwordConfirm:e.confirmPassword,phone:e.phone||null,birthDate:e.birthDate||null}),W.value=e.email,S.value=!0,y.success("Un email de vérification a été envoyé !")}catch(t){f.error("Erreur:",t),N.value.general=x(t)}finally{I.value=!1}},B=()=>{S.value=!1,W.value="",D.value="login",N.value={}},K=async e=>{I.value=!0,N.value.general="";try{const t=await b.forgotPassword(e.email);y.success(t.message),D.value="login"}catch(t){f.error("Erreur:",t),N.value.general=x(t)}finally{I.value=!1}},Q=()=>{D.value="forgot-password",N.value={}},R=s(()=>"login"===D.value?{title:"Connexion",subtitle:"Connectez-vous à votre compte",toggleText:"Vous n'avez pas de compte ?",toggleLink:"Créer un compte"}:"register"===D.value?{title:"Inscription",subtitle:"Créez votre compte gratuitement",toggleText:"Vous avez déjà un compte ?",toggleLink:"Se connecter"}:{title:"Mot de passe oublié",subtitle:"Entrez votre email pour réinitialiser votre mot de passe",toggleText:"Vous vous souvenez de votre mot de passe ?",toggleLink:"Retour à la connexion"});return l(()=>U.query.mode,e=>{"register"===e||"login"===e||"forgot-password"===e?(D.value=e,N.value={}):e||(D.value="login",N.value={})}),(e,t)=>(o(),r(w,null,{default:u(()=>[i(z,{title:R.value.title,subtitle:R.value.subtitle,"error-message":N.value.general},{default:u(()=>["login"===D.value?(o(),r(C,{key:0,"is-submitting":I.value,onSubmit:G,onForgotPassword:Q},null,8,["is-submitting"])):"register"!==D.value||S.value?"register"===D.value&&S.value?(o(),n("div",P,[p("div",V,[m(j).fas?.envelope?(o(),r(m(h),{key:0,icon:m(j).fas.envelope,class:"size-8 text-primary"},null,8,["icon"])):v("",!0)]),p("div",E,[t[1]||(t[1]=p("h3",{class:"text-lg font-semibold text-neutral-900"}," Vérifiez votre boîte mail ",-1)),t[2]||(t[2]=p("p",{class:"text-sm text-neutral-600"}," Un email de vérification a été envoyé à ",-1)),p("p",F,g(W.value),1),t[3]||(t[3]=p("p",{class:"text-sm text-neutral-600"}," Cliquez sur le lien dans l'email pour activer votre compte. ",-1))]),i(m(k),{type:"button",variant:"secondary",rounded:"lg",class:"w-full transition-colors",onClick:B},{default:u(()=>[...t[4]||(t[4]=[c(" Aller à la connexion ",-1)])]),_:1}),t[5]||(t[5]=p("p",{class:"text-xs text-neutral-500"}," Pensez à vérifier vos spams si vous ne trouvez pas l'email. ",-1))])):"forgot-password"===D.value?(o(),r(T,{key:3,"is-submitting":I.value,onSubmit:K},null,8,["is-submitting"])):v("",!0):(o(),r(A,{key:1,"is-submitting":I.value,onSubmit:H},null,8,["is-submitting"])),S.value?v("",!0):(o(),r(L,{key:4,text:R.value.toggleText,"link-text":R.value.toggleLink,onToggle:t[0]||(t[0]=e=>"forgot-password"===D.value?(D.value="login",void(N.value={})):(D.value="login"===D.value?"register":"login",N.value={},S.value=!1,void(W.value="")))},null,8,["text","link-text"]))]),_:1},8,["title","subtitle","error-message"])]),_:1}))}});export{M as default};
